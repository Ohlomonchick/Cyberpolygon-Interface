<head>
<!-- ... -->

{% load django_simple_bulma %}
{% bulma %}
{% load static %}
    <title>ПИК</title>
<link rel="shortcut icon" type="image/png" href="{% static 'icons/letter-k.png' %}"/>
<link rel="stylesheet" href="{% static 'css/font_awesome/all.css' %}">
<link rel="stylesheet" href="{% static 'css/base_styles.css' %}">

    {% block extra_css %}
    {% endblock %}
</head>


<body {% if not allow_copy %} oncopy="return false;" oncontextmenu="return false;" onselectstart="return false;" {% endif %}>
    <div class="flex-wrapper">
        <nav class="navbar is-black" role="navigation" aria-label="main navigation">
          <div class="navbar-brand">
              <figure class="image is-64x64">
                  <img src="{% static 'icons/vuz_logo.png' %}" />
              </figure>
            <a class="navbar-item pl-1 pr-1 no-hover">
              <h1><strong>ПИК «КИБЕРПОЛИГОН»</strong></h1>
            </a>

          </div>
            <div class="navbar-start">
              {% if  user.is_superuser %}
                  <a class="navbar-item" href="{% url 'interface:lab-menu' %}">
                      Лабораторные работы
                  </a>
              {% endif %}

              {% if user.is_authenticated %}
                <a class="navbar-item" href="{% url 'interface:competition-list' %}">
                  Экзамены
                </a>
                  <a class="navbar-item" href="{% url 'interface:team-competition-list' %}">
                  Соревнования
                </a>
                <a class="navbar-item" href="{% url 'interface:competition-history-list' %}">
                  История
                </a>
              {% endif %}

              {% if user.is_superuser %}
                <a class="navbar-item" href = "{% url 'interface:platoon-list' %}">
                  Список взводов
                </a>
              {% endif %}
            </div>

            <div class="navbar-end">
              <div class="navbar-item no-hover">
                <div class="buttons">
                    {% if user.is_authenticated %}
                        {% if user.is_superuser %}
                            <a class="button is-light" href="{% url 'admin:index' %}">
                                <strong>Админ-панель</strong>
                            </a>
                        {% else %}
                          <a class="button is-light" href="{% url 'change_password' %}">
                            <strong>Сменить пароль</strong>
                          </a>
                        {% endif %}
                        <form class="m-0" method="post" action="{% url 'logout' %}">
                            {% csrf_token %}
                            <button class="button is-light" type="submit"><strong>Выйти</strong></button>
                        </form>
                    {% else %}
                      <a class="button is-primary" href="{% url 'reg' %}">
                        <strong>Войти как участник</strong>
                      </a>
                      <a class="button is-light" href="{% url 'login' %}">
                        <strong>Войти как администратор</strong>
                      </a>
                    {% endif %}
                </div>
              </div>
            </div>
        </nav>

        {% block background_video %}
        <!-- Optional: Block to add a background video in derived templates -->
        {% endblock %}
        {% block title_image %}
            <!-- Optional: Block to add an image with text on it -->
        {% endblock %}

        <section class="hero is-flex-grow-1">
            <div class="hero-body is-flex-grow-1 is-flex is-align-items-center {% block hero_class %}{% endblock %}">
                <div class="container is-flex-grow-1 {% block container_class %}{% endblock %}">
                    {% block content %}
                    {% endblock %}
                </div>
            </div>
        </section>

        <footer class="footer {% block footer_class %} {% endblock %} mt-auto">
          {% if request.resolver_match.url_name == "team-competition-detail" or request.resolver_match.url_name == "lab-list" or request.resolver_match.url_name == "competition-detail" %}
            <div style="position: fixed; bottom: 1rem; right: 1rem; ">
                <a class="button is-info is-small"
                   href="{% url 'interface:help-page' %}?next={{ request.get_full_path|urlencode }}">
                    Помощь
                </a>
            </div>
          {% endif %}

          <div class="content has-text-centered">
            <p>
              Разработано в <strong>ВУЦ НИУ ВШЭ</strong>
            </p>
          </div>
        </footer>

    </div>
    
    <!-- jQuery для анимаций -->
    <script src="{% static 'admin/js/jquery-3.7.1.min.js' %}"></script>
    
    <!-- Передача URL из Django в JavaScript -->
    <script>
        window.navbarUrls = {
            'competition-list': "{% url 'interface:competition-list' %}",
            'team-competition-list': "{% url 'interface:team-competition-list' %}",
            'competition-history-list': "{% url 'interface:competition-history-list' %}",
            'lab-menu': "{% url 'interface:lab-menu' %}",
            'lab-list': "{% url 'interface:lab-list' %}",
            'platoon-list': "{% url 'interface:platoon-list' %}",
            'reg': "{% url 'reg' %}",
            'login': "{% url 'login' %}"
        };
    </script>
    
    <script src="{% static 'js/navbar_controller.js' %}"></script>
</body>